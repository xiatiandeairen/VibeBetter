# AEIP 行业专家评审报告 v2

> 以行业专家视角，对当前平台在**产品形态**、**成熟度**、**完成度**和**工程质量**四个维度进行多维评分和深度分析。

---

## 1. 多维度评分卡

> 评分标准：1-10 分，参考行业优秀数据平台（Datadog、SonarQube、LinearB、Sleuth）。

| 维度                | 评分  | 行业标杆 | 差距分析                                           |
| ------------------- | ----- | -------- | -------------------------------------------------- |
| **产品功能完成度**  | 5.5/10 | 8/10    | 核心采集+计算+可视化链路通，但决策引擎和 LLM 分析未闭环 |
| **产品形态成熟度**  | 4/10   | 8/10    | MVP 形态，缺少多租户、权限矩阵、通知系统            |
| **架构设计质量**    | 6.5/10 | 8.5/10  | 分层已改善，Collector 插件化好，但缺少缓存策略和异步事件总线 |
| **代码质量**        | 6/10   | 8/10    | TS 严格模式+Zod+Service 层，但测试覆盖率仍不够      |
| **前端体验**        | 7/10   | 8.5/10  | 暗色主题精致，但交互深度不够（无下钻/筛选/对比）    |
| **数据采集能力**    | 5/10   | 8/10    | GitHub+LocalGit 基础采集，缺少 Webhook/IDE 插件实时数据 |
| **指标体系完备度**  | 6.5/10 | 9/10    | PSRI 6 维+TDI+AI 成果率，但缺少风险传播和依赖图分析 |
| **可观测性/运维**   | 2/10   | 8/10    | 无结构化日志、无监控、无告警、无健康面板             |
| **安全性**          | 3/10   | 8/10    | JWT 基础认证，缺 OAuth/RBAC/CSRF/安全审计           |
| **文档完备度**      | 7/10   | 8/10    | README+spec+plan+analysis 齐全，缺 API 文档和贡献者指南 |

### 综合得分：5.3/10

---

## 2. 产品功能特性评审

### 2.1 已实现能力矩阵

| 功能域               | MVP 状态   | Phase 1 状态 | 说明                                           |
| -------------------- | ---------- | ------------ | ---------------------------------------------- |
| 用户认证             | ✅ 完成     | ⬜ 部分      | JWT 完成，缺 OAuth SSO / Refresh Token          |
| 项目管理             | ✅ 完成     | ⬜ 部分      | CRUD 完成，缺多用户协作                         |
| GitHub PR 采集       | ✅ 完成     | ✅ 增强      | 增量+分页+Rate Limit 感知                       |
| 本地 Git 采集        | ✅ 完成     | —            | 提交历史+文件变更                               |
| AI 行为识别          | ✅ 完成     | ✅ 增强      | Label/Commit + 独立 AI Behavior 数据模型        |
| 用户行为追踪         | —          | ✅ 新增      | 事件记录+聚合统计                               |
| AI Success/Stable Rate | ✅ 完成   | —            | 基于 PR 数据计算                                |
| PSRI 风险指数        | ✅ 3维简化  | ✅ 6维完整   | 含权重配置                                      |
| TDI 技术债指数       | —          | ✅ 新增      | 基于复杂度/变更频率计算                         |
| 决策建议引擎         | —          | ✅ 新增      | 规则驱动，5 条核心规则                          |
| 权重配置             | —          | ✅ 新增      | 项目级可配置                                    |
| Dashboard 可视化     | ✅ 完成     | ✅ 重新设计  | 暗色主题+趋势图+热点文件                        |
| BullMQ 任务队列      | ✅ 完成     | —            | 采集+计算异步任务                               |
| 统一错误处理         | —          | ✅ 新增      | AppError + 全局 onError 中间件                  |
| Service 层分离       | —          | ✅ 新增      | Auth/Project/Decision/Metrics Service           |

### 2.2 关键功能缺失

#### P0 — 仍需完成

| 缺失项                   | 状态     | 说明                                     |
| ------------------------ | -------- | ---------------------------------------- |
| OAuth SSO 登录           | ⬜ 未做   | 企业用户必需                             |
| Webhook 实时数据接入     | ⬜ 未做   | PR 阶段 ≤30s 风险评估的前提              |
| 前端决策建议面板         | ⬜ 未做   | 后端 API 已就绪，前端未接入              |
| 前端权重配置页面         | ⬜ 未做   | 后端 API 已就绪，前端未接入              |

#### P1 — 仍需完成

| 缺失项                   | 状态     | 说明                                     |
| ------------------------ | -------- | ---------------------------------------- |
| 风险传播指数（graphology）| ⬜ 未做  | 依赖图分析，spec 中定义                  |
| 指标下钻交互             | ⬜ 未做   | PSRI → 子维度 → 文件级                  |
| 前端 AI/用户行为面板     | ⬜ 未做   | 后端 API 已就绪，前端未接入              |
| 时间范围筛选器           | ⬜ 未做   | 趋势图支持自定义时间范围                 |

---

## 3. 架构设计评审

### 3.1 架构改善（本轮完成）

| 改善项                | 变化                                        |
| --------------------- | ------------------------------------------- |
| Service 层            | Route → Service → Prisma 分层明确           |
| 错误处理              | AppError + 全局 onError 中间件              |
| GitHub 采集           | 分页 + 增量 + Rate Limit 感知               |
| 指标计算              | 6 维 PSRI + TDI + 权重配置                  |
| 数据模型              | 新增 UserBehavior/AiBehavior/Decision/WeightConfig |

### 3.2 架构仍存不足

| 问题                       | 影响      | 建议                                   |
| -------------------------- | --------- | -------------------------------------- |
| 无事件总线                 | 模块耦合  | 引入 EventEmitter 或 Redis Pub/Sub     |
| 无缓存层                   | 性能      | Redis 缓存高频查询（指标概览/快照）    |
| 无 API 文档自动生成        | DX        | 引入 Hono OpenAPI 或 Swagger 插件      |
| 前端无全局状态管理         | UX        | 引入 Zustand 管理项目选择/认证状态     |
| 无结构化日志               | 运维      | 引入 pino 替代 console.error           |
| 无健康检查细粒度           | SRE       | /health 应检查 DB+Redis 连接状态       |

---

## 4. 代码质量评审

### 4.1 质量改善（本轮完成）

| 改善项           | 说明                                   |
| ---------------- | -------------------------------------- |
| Service 层测试   | 21 个 server 测试（含 PSRI/TDI/决策）  |
| Shared 测试      | 8 个 shared 工具函数测试               |
| AppError 类型    | 替代原始 throw + try/catch             |
| 路由薄层化       | auth/projects 路由不再直接调用 Prisma   |

### 4.2 质量仍存不足

| 问题                         | 影响     | 建议                                |
| ---------------------------- | -------- | ----------------------------------- |
| API 集成测试覆盖率为 0       | 高       | 使用 supertest + 测试数据库          |
| 前端零测试                   | 高       | 添加 Vitest + Testing Library        |
| MetricsService 多次查询      | 性能     | 合并查询，一次加载所有数据           |
| 部分 Collector 未注册到路由  | 功能     | LocalGit collector 未在 behaviors 中暴露 |
| 种子数据随机性               | 测试     | 使用确定性种子便于 CI 验证           |

### 4.3 测试覆盖率现状

| 模块              | 单元测试 | 集成测试 | 总体   |
| ----------------- | -------- | -------- | ------ |
| MetricsService    | ★★★★☆   | ☆☆☆☆☆   | 60%    |
| DecisionService   | ★★★☆☆   | ☆☆☆☆☆   | 40%    |
| AuthService       | ☆☆☆☆☆   | ☆☆☆☆☆   | 0%     |
| ProjectService    | ☆☆☆☆☆   | ☆☆☆☆☆   | 0%     |
| Collectors        | ☆☆☆☆☆   | ☆☆☆☆☆   | 0%     |
| 前端组件          | ☆☆☆☆☆   | ☆☆☆☆☆   | 0%     |
| Shared Utils      | ★★★★★   | —        | 90%    |

---

## 5. 产品形态成熟度评估

### 5.1 当前产品阶段：**Early MVP → Late MVP 过渡中**

| 维度           | 状态                                                      |
| -------------- | --------------------------------------------------------- |
| 核心价值验证   | 部分完成 — 采集→计算→可视化链路通，决策闭环未完成          |
| 用户旅程完整性 | 60% — 注册→创建项目→查看指标可用，但决策建议/权重配置前端未接入 |
| 数据深度       | 40% — 基础指标可用，高级分析（传播/对比/下钻）未实现      |
| 可运营性       | 20% — 无监控/告警/日志分析/用户反馈渠道                   |
| 商业化准备度   | 10% — 无计费/套餐/多租户隔离/SLA                          |

### 5.2 与行业标杆对比

| 能力                | VibeBetter  | SonarQube | LinearB | Sleuth  |
| ------------------- | ----------- | --------- | ------- | ------- |
| 代码质量分析        | ★★☆☆☆      | ★★★★★    | ★★★☆☆  | ★★☆☆☆  |
| AI 编码洞察         | ★★★★☆      | ☆☆☆☆☆    | ★★☆☆☆  | ☆☆☆☆☆  |
| 风险预测            | ★★★☆☆      | ★★★☆☆    | ★★★★☆  | ★★★★☆  |
| 团队效能分析        | ★☆☆☆☆      | ☆☆☆☆☆    | ★★★★★  | ★★★★☆  |
| 部署风险            | ☆☆☆☆☆      | ☆☆☆☆☆    | ★★★☆☆  | ★★★★★  |
| 决策建议            | ★★★☆☆      | ★★☆☆☆    | ★★★☆☆  | ★★☆☆☆  |
| **差异化优势**      | AI Coding 专项洞察 | — | — | — |

> VibeBetter 的核心差异化在于 **AI Coding 专项洞察**（AI Success Rate、AI Stable Rate、AI 行为追踪），这是 SonarQube/LinearB/Sleuth 均未覆盖的领域。

---

## 6. 改进路线建议

### 6.1 下一迭代优先级（建议 Phase 1.5）

| 优先级 | 任务                               | 预估 | 影响                      |
| ------ | ---------------------------------- | ---- | ------------------------- |
| P0     | 前端接入决策建议 + 权重配置页面    | 2d   | 核心闭环                  |
| P0     | 前端接入 AI/用户行为分析面板       | 2d   | 数据源价值展现            |
| P0     | OAuth SSO（GitHub）                | 2d   | 用户获取                  |
| P1     | Webhook 实时 PR 风险评估           | 3d   | 核心价值                  |
| P1     | graphology 风险传播指数            | 2d   | 指标完备                  |
| P1     | 指标下钻交互（PSRI→子维度→文件）   | 2d   | 用户体验                  |
| P2     | 结构化日志（pino）+ 健康检查增强   | 1d   | 可运维性                  |
| P2     | API 集成测试                       | 2d   | 代码质量                  |
| P2     | ECharts 按需加载                   | 0.5d | 性能                      |
