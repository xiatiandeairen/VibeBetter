# AI-Augmented Engineering Insight Platform（AEIP）— 产品规格说明书

---

## 1. 文档信息

| 项目     | 内容                                              |
| -------- | ------------------------------------------------- |
| 产品名称 | AI-Augmented Engineering Insight Platform（AEIP） |
| 文档版本 | v1.0                                              |
| 文档类型 | 产品规格说明书（Spec）                            |
| 目标版本 | MVP + Phase 1                                     |
| 面向对象 | 技术管理层 / 架构团队 / DevOps / 数据团队         |

---

## 2. 背景与问题定义

随着 AI Coding 在研发流程中的大规模应用，组织面临以下核心问题：

1. AI 是否真正提升了工程效率？
2. AI 是否引入结构风险与技术债？
3. 哪些模块适合 AI，哪些不适合？
4. AI 是否对线上事故产生隐性影响？
5. 如何用数据驱动 AI 使用决策？

**当前缺乏：**

- 全链路数据采集能力
- 可解释风险模型
- AI 成果率量化机制
- 结构风险传播分析
- 工业级决策支持系统

---

## 3. 产品目标

构建一套工业级 AI Coding Insight 平台，实现：

- 全生命周期数据采集
- 结构风险量化
- AI Coding 成果率衡量
- 风险预测能力
- 决策建议自动生成
- 技术债趋势管理

---

## 4. 非目标（Out of Scope）

- 替代代码托管平台
- 替代 CI/CD 系统
- 替代 APM 平台
- 提供代码自动修复能力（后续阶段）

---

## 5. 核心用户角色

| 角色                | 关注点         |
| ------------------- | -------------- |
| CTO                 | ROI / 风险控制 |
| 架构师              | 结构稳定性     |
| Engineering Manager | AI 成果率      |
| Tech Lead           | 模块风险       |
| DevOps              | 发布风险       |
| 数据团队            | 特征建模       |

---

## 6. 产品范围（Scope）

覆盖以下工程域：

1. 需求域
2. 架构域
3. 代码结构域
4. 协作与变更域
5. 测试域
6. 缺陷域
7. 运行期域
8. 交付域

---

## 7. 功能需求

### 7.1 数据采集模块

#### 7.1.1 需求域采集

**采集方式：**

- PRD 文档接入
- LLM 解析需求复杂度
- 规则数量识别
- 模块影响分析

**输出字段：**

| 字段                    | 说明         |
| ----------------------- | ------------ |
| `requirement_id`        | 需求唯一标识 |
| `module_count`          | 涉及模块数   |
| `rule_complexity_score` | 规则复杂度   |
| `state_machine_count`   | 状态机数量   |
| `business_criticality`  | 业务关键度   |

#### 7.1.2 架构域采集

**采集方式：**

- 服务依赖图
- 包依赖图
- 数据库依赖
- 跨层访问检测

**输出指标：**

| 指标                      | 说明         |
| ------------------------- | ------------ |
| `cyclic_dependency_count` | 循环依赖数   |
| `fan_in`                  | 扇入         |
| `fan_out`                 | 扇出         |
| `cross_layer_ratio`       | 跨层访问比率 |

#### 7.1.3 代码结构采集

**集成工具：**

- SonarQube
- Lizard
- 覆盖率工具

**输出字段：**

| 字段                   | 说明         |
| ---------------------- | ------------ |
| `cc_total`             | 圈复杂度总计 |
| `cognitive_complexity` | 认知复杂度   |
| `cbo`                  | 对象耦合度   |
| `lcom`                 | 内聚度       |
| `duplication_ratio`    | 重复率       |
| `code_smell_count`     | 代码异味数   |
| `coverage_line`        | 行覆盖率     |
| `coverage_branch`      | 分支覆盖率   |

#### 7.1.4 AI 行为采集

**采集方式：** 通过 IDE 插件或 PR 标签识别。

**输出字段：**

| 字段               | 说明         |
| ------------------ | ------------ |
| `ai_used`          | 是否使用 AI  |
| `generation_count` | AI 生成次数  |
| `regenerate_count` | 重新生成次数 |
| `prompt_hash`      | Prompt 哈希  |
| `edit_distance`    | 编辑距离     |
| `ai_code_ratio`    | AI 代码占比  |

#### 7.1.5 变更协作采集

**输出字段：**

| 字段               | 说明          |
| ------------------ | ------------- |
| `commit_count_90d` | 90 天提交数   |
| `author_count`     | 作者数        |
| `review_rounds`    | Review 轮数   |
| `review_comments`  | Review 评论数 |
| `merge_time`       | 合并耗时      |
| `conflict_count`   | 冲突次数      |

#### 7.1.6 缺陷与事故采集

**输出字段：**

| 字段             | 说明         |
| ---------------- | ------------ |
| `bug_count_90d`  | 90 天缺陷数  |
| `incident_count` | 事故数       |
| `reopen_rate`    | 重开率       |
| `mttr`           | 平均修复时间 |
| `rollback_flag`  | 是否回滚     |

#### 7.1.7 运行期采集

**输出字段：**

| 字段                  | 说明         |
| --------------------- | ------------ |
| `error_rate`          | 错误率       |
| `latency_p95`         | P95 延迟     |
| `memory_spike`        | 内存飙升     |
| `sla_violation_count` | SLA 违规次数 |

---

## 8. 指标体系

### 8.1 AI 成果指标

#### AI Success Rate（AI 成功率）

```
AI_Success_Rate =
  无重大修改合并 PR 数
  ÷
  AI 参与 PR 数
```

#### AI Stable Rate（AI 稳定率）

```
AI_Stable_Rate =
  无回滚 PR 数
  ÷
  AI PR 数
```

### 8.2 结构风险指标

#### Structural Risk Index（PSRI）

```
PSRI =
  w1 × ArchitectureRisk +
  w2 × StructuralRisk +
  w3 × ChangeRisk +
  w4 × DefectRisk +
  w5 × RuntimeRisk +
  w6 × CoverageGap
```

> 权重 w1–w6 可配置。

### 8.3 技术债指数（TDI）

```
TDI =
  (高复杂度文件比例 + 重复率 + 低覆盖比例)
  × 修改频率
```

### 8.4 风险传播指数

基于依赖图计算：

```
PropagationRisk =
  节点风险 × 中心度
```

---

## 9. 分析与模型层

### 9.1 规则模型

| 条件                        | 结论       |
| --------------------------- | ---------- |
| 高频修改 + 高复杂度         | 热点文件   |
| AI 修改热点文件且复杂度上升 | 风险放大   |
| 覆盖率下降 + 缺陷上升       | 技术债增长 |

### 9.2 机器学习模型

**训练数据：**

- 历史事故
- 结构指标
- AI 使用比例

**输出：**

- 事故概率预测
- 高风险模块预测

---

## 10. 决策建议引擎

### 10.1 模块级建议

| 条件                                | 建议             |
| ----------------------------------- | ---------------- |
| AI Success Rate > 90% 且 PSRI < 0.3 | 扩大 AI 使用     |
| PSRI > 0.6 且回滚率上升             | 限制 AI 自动生成 |

### 10.2 Sprint 级建议

- Top 10 风险文件进入 Sprint
- 新需求影响高风险模块需架构评审

### 10.3 组织级建议

- 团队 AI 绩效排名
- 适配模块推荐
- 技术债增长预警

---

## 11. Dashboard 需求

必须包含以下面板：

| #   | 面板         | 说明                              |
| --- | ------------ | --------------------------------- |
| 1   | AI 使用概览  | AI 使用率、生成次数、代码占比趋势 |
| 2   | 结构风险趋势 | PSRI 历史变化、模块风险排名       |
| 3   | 技术债趋势   | TDI 变化、高风险文件增减          |
| 4   | 风险热力图   | 模块维度风险可视化                |
| 5   | 事故预测面板 | ML 模型输出、概率排名             |
| 6   | ROI 报告     | AI 投入产出比、效率对比           |

---

## 12. 非功能性需求

| 项目     | 要求           |
| -------- | -------------- |
| 可扩展性 | 支持百万级文件 |
| 数据延迟 | 批处理 ≤ 24h   |
| 实时风险 | PR 阶段 ≤ 30s  |
| 安全性   | 企业级数据隔离 |
| 可解释性 | 所有评分可追溯 |
